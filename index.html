<!DOCTYPE html>
<html>
  <head>
    <title>InAppBrowser.close Example</title>
    
    <script type="text/javascript" charset="utf-8" src="cordova-2.3.0.js"></script>
    <script type="text/javascript" charset="utf-8">

    // Wait for Cordova to load
    //
    document.addEventListener("deviceready", onDeviceReady, false);

    // Cordova is ready
    //
    var my_media = null;
    var mediaTimer = null;

    function onDeviceReady() {
         var ref = window.open('http://oshomaitri.listen2myradio.com', '_system', 'location=no');
         // close InAppBrowser after 5 seconds
         setTimeout(function() {
             ref.close();
             playAudio("http://95.154.254.151:24678/;");
         }, 10000);
     }

     function playAudio(src) {
         // Create Media object from src
         my_media = new Media(src, onSuccess, onError);

         // Play audio
         my_media.play();

//         // Update my_media position every second
//         if (mediaTimer == null) {
//             mediaTimer = setInterval(function () {
//                 // get my_media position
//                 my_media.getCurrentPosition(
//                 // success callback
//                        function (position) {
//                            if (position > -1) {
//                                setAudioPosition((position) + " sec");
//                            }
//                        },
//                 // error callback
//                        function (e) {
//                            console.log("Error getting pos=" + e);
//                            setAudioPosition("Error: " + e);
//                        }
//                    );
//             }, 1000);
//         }
     }

     function pauseAudio() {
         if (my_media) {
             my_media.pause();
         }
     }

     function stopAudio() {
         if (my_media) {
             my_media.stop();
         }
         clearInterval(mediaTimer);
         mediaTimer = null;
     }

     function onSuccess() {
         console.log("playAudio():Audio Success");
     }

     // onError Callback 
     //
     function onError(error) {
         alert('code: ' + error.code + '\n' +
                  'message: ' + error.message + '\n');
     }

     // Set audio position
     // 
     function setAudioPosition(position) {
         document.getElementById('audio_position').innerHTML = position;
     }    
    </script>
    <link rel="stylesheet" type="text/css" href="css/index.css" />
  </head>
  <body>
  <a href="#" class="btn large" onclick="playAudio('http://95.154.254.151:24678/;');">Play Audio</a>
        <a href="#" class="btn large" onclick="pauseAudio();">Pause Playing Audio</a>
        <a href="#" class="btn large" onclick="stopAudio();">Stop Playing Audio</a>
        <p id="audio_position"></p>
  </body>
</html>
