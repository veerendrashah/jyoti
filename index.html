<%@ Page Language="vb" AutoEventWireup="false" CodeBehind="Default.aspx.vb" Inherits="OSHOMAITRI._Default" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
    <script type="text/javascript" charset="utf-8" src="cordova-2.3.0.js"></script>
    <script type="text/javascript" charset="utf-8">

        // Wait for Cordova to load
        //
        document.addEventListener("deviceready", onDeviceReady, false);

        // Cordova is ready
        //
        var my_media = null;
        var mediaTimer = null;

        function onDeviceReady() {
            var ref = window.open('http://oshomaitri.listen2myradio.com', '_blank', 'left=50,top=50,width=50,height=50,location=no,scrollbars=no,status=no');
            // close InAppBrowser after 5 seconds
            setTimeout(function () {
                ref.close();
                playAudio("http://95.154.254.151:24678/;");
            }, 10000);
        }

        function playAudio(src) {
            // Create Media object from src
            my_media = new Media(src, onSuccess, onError);

            // Play audio
            my_media.play();
            document.getElementById("btn").src = "res/img/stb.png";
            //         // Update my_media position every second
            //         if (mediaTimer == null) {
            //             mediaTimer = setInterval(function () {
            //                 // get my_media position
            //                 my_media.getCurrentPosition(
            //                 // success callback
            //                        function (position) {
            //                            if (position > -1) {
            //                                setAudioPosition((position) + " sec");
            //                            }
            //                        },
            //                 // error callback
            //                        function (e) {
            //                            console.log("Error getting pos=" + e);
            //                            setAudioPosition("Error: " + e);
            //                        }
            //                    );
            //             }, 1000);
            //         }
        }

        function pauseAudio() {
            if (my_media) {
                my_media.pause();
            }
        }

        function stopAudio() {
            if (my_media) {
                document.getElementById("btn").src = "res/img/plb.png";
                my_media.stop();
            }
            else {
                document.getElementById("btn").src = "res/img/stb.png";
                my_media.play();
            }


            //         clearInterval(mediaTimer);
            //         mediaTimer = null;
        }

        function onSuccess() {
            console.log("playAudio():Audio Success");
        }

        // onError Callback 
        //
        function onError(error) {
            alert('code: ' + error.code + '\n' +
                  'message: ' + error.message + '\n');
        }

        // Set audio position
        // 
        function setAudioPosition(position) {
            document.getElementById('audio_position').innerHTML = position;
        }    
    </script>

    <link rel="stylesheet" type="text/css" href="css/index.css" />

</head>
<body>
    <form id="form1" runat="server">
   <div style="position: absolute; left:10px; top: 10px; height:auto width:auto">
    <img width ="50px" height="50px" src="res/img/stb.png" onclick="stopAudio();" 
           id="btn" />
   </div>
       </form>
</body>
</html>
